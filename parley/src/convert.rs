// Copyright 2024 the Parley Authors
// SPDX-License-Identifier: Apache-2.0 OR MIT

pub(crate) fn script_to_harfrust(script: fontique::Script) -> harfrust::Script {
    const VALUES: &[harfrust::Script] = &[
        harfrust::script::COMMON,
        harfrust::script::INHERITED,
        harfrust::script::ARABIC,
        harfrust::script::ARMENIAN,
        harfrust::script::BENGALI,
        harfrust::script::BOPOMOFO,
        harfrust::script::CHEROKEE,
        harfrust::script::COPTIC,
        harfrust::script::CYRILLIC,
        harfrust::script::DESERET,
        harfrust::script::DEVANAGARI,
        harfrust::script::ETHIOPIC,
        harfrust::script::GEORGIAN,
        harfrust::script::GOTHIC,
        harfrust::script::GREEK,
        harfrust::script::GUJARATI,
        harfrust::script::GURMUKHI,
        harfrust::script::HAN,
        harfrust::script::HANGUL,
        harfrust::script::HEBREW,
        harfrust::script::HIRAGANA,
        harfrust::script::KANNADA,
        harfrust::script::KATAKANA,
        harfrust::script::KHMER,
        harfrust::script::LAO,
        harfrust::script::LATIN,
        harfrust::script::MALAYALAM,
        harfrust::script::MONGOLIAN,
        harfrust::script::MYANMAR,
        harfrust::script::OGHAM,
        harfrust::script::OLD_ITALIC,
        harfrust::script::ORIYA,
        harfrust::script::RUNIC,
        harfrust::script::SINHALA,
        harfrust::script::SYRIAC,
        harfrust::script::TAMIL,
        harfrust::script::TELUGU,
        harfrust::script::THAANA,
        harfrust::Script::from_iso15924_tag(harfrust::Tag::new(b"Thai")).unwrap(),
        harfrust::script::TIBETAN,
        harfrust::Script::from_iso15924_tag(harfrust::Tag::new(b"Cans")).unwrap(),
        harfrust::script::YI,
        harfrust::script::TAGALOG,
        harfrust::script::HANUNOO,
        harfrust::script::BUHID,
        harfrust::script::TAGBANWA,
        harfrust::script::BRAILLE,
        harfrust::script::CYPRIOT,
        harfrust::script::LIMBU,
        harfrust::script::LINEAR_B,
        harfrust::script::OSMANYA,
        harfrust::script::SHAVIAN,
        harfrust::script::TAI_LE,
        harfrust::script::UGARITIC,
        harfrust::Script::from_iso15924_tag(harfrust::Tag::new(b"Hrkt")).unwrap(),
        harfrust::script::BUGINESE,
        harfrust::script::GLAGOLITIC,
        harfrust::script::KHAROSHTHI,
        harfrust::script::SYLOTI_NAGRI,
        harfrust::script::NEW_TAI_LUE,
        harfrust::script::TIFINAGH,
        harfrust::script::OLD_PERSIAN,
        harfrust::script::BALINESE,
        harfrust::script::BATAK,
        harfrust::Script::from_iso15924_tag(harfrust::Tag::new(b"Blis")).unwrap(),
        harfrust::script::BRAHMI,
        harfrust::Script::from_iso15924_tag(harfrust::Tag::new(b"Cham")).unwrap(),
        harfrust::Script::from_iso15924_tag(harfrust::Tag::new(b"Cirt")).unwrap(),
        harfrust::Script::from_iso15924_tag(harfrust::Tag::new(b"Cyrs")).unwrap(),
        harfrust::Script::from_iso15924_tag(harfrust::Tag::new(b"Egyd")).unwrap(),
        harfrust::Script::from_iso15924_tag(harfrust::Tag::new(b"Egyh")).unwrap(),
        harfrust::script::EGYPTIAN_HIEROGLYPHS,
        harfrust::Script::from_iso15924_tag(harfrust::Tag::new(b"Geok")).unwrap(),
        harfrust::Script::from_iso15924_tag(harfrust::Tag::new(b"Hans")).unwrap(),
        harfrust::Script::from_iso15924_tag(harfrust::Tag::new(b"Hant")).unwrap(),
        harfrust::script::PAHAWH_HMONG,
        harfrust::script::OLD_HUNGARIAN,
        harfrust::Script::from_iso15924_tag(harfrust::Tag::new(b"Inds")).unwrap(),
        harfrust::script::JAVANESE,
        harfrust::script::KAYAH_LI,
        harfrust::Script::from_iso15924_tag(harfrust::Tag::new(b"Latf")).unwrap(),
        harfrust::Script::from_iso15924_tag(harfrust::Tag::new(b"Latg")).unwrap(),
        harfrust::script::LEPCHA,
        harfrust::script::LINEAR_A,
        harfrust::script::MANDAIC,
        harfrust::Script::from_iso15924_tag(harfrust::Tag::new(b"Maya")).unwrap(),
        harfrust::script::MEROITIC_HIEROGLYPHS,
        harfrust::script::NKO,
        harfrust::script::OLD_TURKIC,
        harfrust::script::OLD_PERMIC,
        harfrust::script::PHAGS_PA,
        harfrust::script::PHOENICIAN,
        harfrust::script::MIAO,
        harfrust::Script::from_iso15924_tag(harfrust::Tag::new(b"Roro")).unwrap(),
        harfrust::Script::from_iso15924_tag(harfrust::Tag::new(b"Sara")).unwrap(),
        harfrust::Script::from_iso15924_tag(harfrust::Tag::new(b"Syre")).unwrap(),
        harfrust::Script::from_iso15924_tag(harfrust::Tag::new(b"Syrj")).unwrap(),
        harfrust::Script::from_iso15924_tag(harfrust::Tag::new(b"Syrn")).unwrap(),
        harfrust::Script::from_iso15924_tag(harfrust::Tag::new(b"Teng")).unwrap(),
        harfrust::script::VAI,
        harfrust::Script::from_iso15924_tag(harfrust::Tag::new(b"Visp")).unwrap(),
        harfrust::script::CUNEIFORM,
        harfrust::Script::from_iso15924_tag(harfrust::Tag::new(b"Zxxx")).unwrap(),
        harfrust::script::UNKNOWN,
        harfrust::script::CARIAN,
        harfrust::Script::from_iso15924_tag(harfrust::Tag::new(b"Jpan")).unwrap(),
        harfrust::script::TAI_THAM,
        harfrust::script::LYCIAN,
        harfrust::script::LYDIAN,
        harfrust::script::OL_CHIKI,
        harfrust::script::REJANG,
        harfrust::script::SAURASHTRA,
        harfrust::script::SIGNWRITING,
        harfrust::script::SUNDANESE,
        harfrust::Script::from_iso15924_tag(harfrust::Tag::new(b"Moon")).unwrap(),
        harfrust::script::MEETEI_MAYEK,
        harfrust::script::IMPERIAL_ARAMAIC,
        harfrust::script::AVESTAN,
        harfrust::script::CHAKMA,
        harfrust::Script::from_iso15924_tag(harfrust::Tag::new(b"Kore")).unwrap(),
        harfrust::script::KAITHI,
        harfrust::script::MANICHAEAN,
        harfrust::script::INSCRIPTIONAL_PAHLAVI,
        harfrust::script::PSALTER_PAHLAVI,
        harfrust::Script::from_iso15924_tag(harfrust::Tag::new(b"Phlv")).unwrap(),
        harfrust::script::INSCRIPTIONAL_PARTHIAN,
        harfrust::script::SAMARITAN,
        harfrust::script::TAI_VIET,
        harfrust::Script::from_iso15924_tag(harfrust::Tag::new(b"Zmth")).unwrap(),
        harfrust::Script::from_iso15924_tag(harfrust::Tag::new(b"Zsym")).unwrap(),
        harfrust::script::BAMUM,
        harfrust::Script::from_iso15924_tag(harfrust::Tag::new(b"Lisu")).unwrap(),
        harfrust::Script::from_iso15924_tag(harfrust::Tag::new(b"Nkgb")).unwrap(),
        harfrust::script::OLD_SOUTH_ARABIAN,
        harfrust::script::BASSA_VAH,
        harfrust::script::DUPLOYAN,
        harfrust::script::ELBASAN,
        harfrust::script::GRANTHA,
        harfrust::Script::from_iso15924_tag(harfrust::Tag::new(b"Kpel")).unwrap(),
        harfrust::Script::from_iso15924_tag(harfrust::Tag::new(b"Loma")).unwrap(),
        harfrust::script::MENDE_KIKAKUI,
        harfrust::script::MEROITIC_CURSIVE,
        harfrust::script::OLD_NORTH_ARABIAN,
        harfrust::script::NABATAEAN,
        harfrust::script::PALMYRENE,
        harfrust::script::KHUDAWADI,
        harfrust::script::WARANG_CITI,
        harfrust::Script::from_iso15924_tag(harfrust::Tag::new(b"Afak")).unwrap(),
        harfrust::Script::from_iso15924_tag(harfrust::Tag::new(b"Jurc")).unwrap(),
        harfrust::script::MRO,
        harfrust::script::NUSHU,
        harfrust::script::SHARADA,
        harfrust::script::SORA_SOMPENG,
        harfrust::script::TAKRI,
        harfrust::script::TANGUT,
        harfrust::Script::from_iso15924_tag(harfrust::Tag::new(b"Wole")).unwrap(),
        harfrust::script::ANATOLIAN_HIEROGLYPHS,
        harfrust::script::KHOJKI,
        harfrust::script::TIRHUTA,
        harfrust::script::CAUCASIAN_ALBANIAN,
        harfrust::script::MAHAJANI,
        harfrust::Script::from_iso15924_tag(harfrust::Tag::new(b"Ahom")).unwrap(),
        harfrust::script::HATRAN,
        harfrust::Script::from_iso15924_tag(harfrust::Tag::new(b"Modi")).unwrap(),
        harfrust::script::MULTANI,
        harfrust::script::PAU_CIN_HAU,
        harfrust::script::SIDDHAM,
        harfrust::script::ADLAM,
        harfrust::script::BHAIKSUKI,
        harfrust::script::MARCHEN,
        harfrust::Script::from_iso15924_tag(harfrust::Tag::new(b"Newa")).unwrap(),
        harfrust::script::OSAGE,
        harfrust::Script::from_iso15924_tag(harfrust::Tag::new(b"Hanb")).unwrap(),
        harfrust::Script::from_iso15924_tag(harfrust::Tag::new(b"Jamo")).unwrap(),
        harfrust::Script::from_iso15924_tag(harfrust::Tag::new(b"Zsye")).unwrap(),
        harfrust::script::MASARAM_GONDI,
        harfrust::script::SOYOMBO,
        harfrust::script::ZANABAZAR_SQUARE,
        harfrust::script::DOGRA,
        harfrust::script::GUNJALA_GONDI,
        harfrust::script::MAKASAR,
        harfrust::script::MEDEFAIDRIN,
        harfrust::script::HANIFI_ROHINGYA,
        harfrust::script::SOGDIAN,
        harfrust::script::OLD_SOGDIAN,
        harfrust::script::ELYMAIC,
        harfrust::script::NYIAKENG_PUACHUE_HMONG,
        harfrust::script::NANDINAGARI,
        harfrust::script::WANCHO,
        harfrust::script::CHORASMIAN,
        harfrust::script::DIVES_AKURU,
        harfrust::script::KHITAN_SMALL_SCRIPT,
        harfrust::script::YEZIDI,
        harfrust::script::CYPRO_MINOAN,
        harfrust::script::OLD_UYGHUR,
        harfrust::script::TANGSA,
        harfrust::Script::from_iso15924_tag(harfrust::Tag::new(b"Toto")).unwrap(),
        harfrust::script::VITHKUQI,
        harfrust::Script::from_iso15924_tag(harfrust::Tag::new(b"Kawi")).unwrap(),
        harfrust::script::NAG_MUNDARI,
        harfrust::Script::from_iso15924_tag(harfrust::Tag::new(b"Aran")).unwrap(),
        harfrust::script::GARAY,
        harfrust::script::GURUNG_KHEMA,
        harfrust::script::KIRAT_RAI,
        harfrust::script::OL_ONAL,
        harfrust::script::SUNUWAR,
        harfrust::script::TODHRI,
        harfrust::script::TULU_TIGALARI,
        harfrust::script::BERIA_ERFE,
        harfrust::script::SIDETIC,
        harfrust::script::TAI_YO,
        harfrust::script::TOLONG_SIKI,
        harfrust::Script::from_iso15924_tag(harfrust::Tag::new(b"Hntl")).unwrap(),
    ];
    VALUES
        .get(script.to_icu4c_value() as usize)
        .copied()
        .unwrap_or(harfrust::script::UNKNOWN)
}

#[test]
fn test_conversion_correct() {
    for i in 0..u16::MAX {
        let fontique_script = fontique::Script::from_icu4c_value(i);

        if let Some(s) = icu_properties::PropertyNamesShort::<fontique::Script>::new()
            .get_locale_script(fontique_script)
        {
            assert_eq!(
                script_to_harfrust(fontique_script),
                harfrust::Script::from_iso15924_tag(harfrust::Tag::new(&s.into_raw())).unwrap(),
                "{s}",
            );
        }
    }
}
